# StoryWorld Frontend on Netlify
# Backend API: Fly.io (https://story-world.fly.dev)

[build]
  publish = "."
  command = "true"

# Serve static frontend (index at /)
[[redirects]]
  from = "/"
  to = "/static/index.html"
  status = 200

[[redirects]]
  from = "/new.html"
  to = "/static/new.html"
  status = 200

[[redirects]]
  from = "/simulation.html"
  to = "/static/simulation.html"
  status = 200

# Proxy API calls to Fly.io backend
[[redirects]]
  from = "/health"
  to = "https://story-world.fly.dev/health"
  status = 200
  force = true

[[redirects]]
  from = "/episodes"
  to = "https://story-world.fly.dev/episodes"
  status = 200
  force = true

[[redirects]]
  from = "/episodes/*"
  to = "https://story-world.fly.dev/episodes/:splat"
  status = 200
  force = true

[[redirects]]
  from = "/simulate"
  to = "https://story-world.fly.dev/simulate"
  status = 200
  force = true

[[redirects]]
  from = "/world-state/*"
  to = "https://story-world.fly.dev/world-state/:splat"
  status = 200
  force = true

[[redirects]]
  from = "/phase-status"
  to = "https://story-world.fly.dev/phase-status"
  status = 200
  force = true

[[redirects]]
  from = "/internal/*"
  to = "https://story-world.fly.dev/internal/:splat"
  status = 200
  force = true

[[redirects]]
  from = "/diagnostics/*"
  to = "https://story-world.fly.dev/diagnostics/:splat"
  status = 200
  force = true

[[redirects]]
  from = "/debug/*"
  to = "https://story-world.fly.dev/debug/:splat"
  status = 200
  force = true

[[redirects]]
  from = "/docs"
  to = "https://story-world.fly.dev/docs"
  status = 200
  force = true

[[redirects]]
  from = "/openapi.json"
  to = "https://story-world.fly.dev/openapi.json"
  status = 200
  force = true
